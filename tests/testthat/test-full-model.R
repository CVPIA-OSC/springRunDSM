library(testthat)
library(springRunDSM)

# Model seeds ---
expected_model_seeds <- structure(c(0, 0, 507, 0, 0, 6700, 552, 0, 0, 307, 0, 409, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 313, 
                                     0, 0, 4321, 354, 0, 0, 175, 0, 242, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 122, 0, 0, 1762, 136, 0, 
                                     0, 59, 0, 91, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 28, 0, 0, 409, 27, 0, 0, 13, 0, 20, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), .Dim = c(31L, 25L
                                     ), .Dimnames = list(c("Upper Sacramento River", "Antelope Creek", 
                                                           "Battle Creek", "Bear Creek", "Big Chico Creek", "Butte Creek", 
                                                           "Clear Creek", "Cottonwood Creek", "Cow Creek", "Deer Creek", 
                                                           "Elder Creek", "Mill Creek", "Paynes Creek", "Stony Creek", "Thomes Creek", 
                                                           "Upper-mid Sacramento River", "Sutter Bypass", "Bear River", 
                                                           "Feather River", "Yuba River", "Lower-mid Sacramento River", 
                                                           "Yolo Bypass", "American River", "Lower Sacramento River", "Calaveras River", 
                                                           "Cosumnes River", "Mokelumne River", "Merced River", "Stanislaus River", 
                                                           "Tuolumne River", "San Joaquin River"), NULL))


expected_model_seeds_stoch <- structure(c(0, 0, 507, 0, 0, 6700, 552, 0, 0, 307, 0, 409, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 313, 
                                          0, 0, 4321, 354, 0, 0, 175, 0, 242, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 122, 0, 0, 1762, 136, 0, 
                                          0, 59, 0, 91, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 28, 0, 0, 409, 27, 0, 0, 13, 0, 20, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), .Dim = c(31L, 25L
                                          ), .Dimnames = list(c("Upper Sacramento River", "Antelope Creek", 
                                                                "Battle Creek", "Bear Creek", "Big Chico Creek", "Butte Creek", 
                                                                "Clear Creek", "Cottonwood Creek", "Cow Creek", "Deer Creek", 
                                                                "Elder Creek", "Mill Creek", "Paynes Creek", "Stony Creek", "Thomes Creek", 
                                                                "Upper-mid Sacramento River", "Sutter Bypass", "Bear River", 
                                                                "Feather River", "Yuba River", "Lower-mid Sacramento River", 
                                                                "Yolo Bypass", "American River", "Lower Sacramento River", "Calaveras River", 
                                                                "Cosumnes River", "Mokelumne River", "Merced River", "Stanislaus River", 
                                                                "Tuolumne River", "San Joaquin River"), NULL))
#Deterministic
test_that("model seed returns correct data structure (deterministic)", {
  model_seed <- spring_run_model(mode = "seed")
  
  expect_equal(dim(model_seed), c(31, 25)) 
  expect_equal(rownames(model_seed), springRunDSM::watershed_labels) 
  expect_equal(sum(model_seed[,5:25]), 0) 
})

test_that("model seed returns correct values (deterministic)", {
  model_seed <- spring_run_model(mode = "seed")
  
  expect_equal(model_seed, expected_model_seeds)
})

#Stochastic
test_that("model seed returns correct data structure (stochastic)", {
  set.seed(2021)
  model_seed <- spring_run_model(mode = "seed")
  
  expect_equal(dim(model_seed), c(31, 25))
  expect_equal(rownames(model_seed), springRunDSM::watershed_labels)
  expect_equal(sum(model_seed[,5:25]), 0) 
})

test_that("model seed returns correct values (stochastic)", {
  set.seed(2021)
  model_seed <- spring_run_model(mode = "seed")

  expect_equal(model_seed, expected_model_seeds_stoch)
})


# Model Simulation -----------------
expected_model_sim <- list(spawners = structure(c(24, 46, 519, 0, 30, 5974, 535, 24, 
                                                  0, 347, 0, 406, 0, 0, 24, 0, 0, 0, 5009, 739, 0, 0, 0, 0, 24, 
                                                  24, 24, 24, 24, 24, 0, 16, 29, 330, 0, 22, 3856, 345, 16, 0, 
                                                  213, 0, 242, 0, 0, 16, 0, 0, 0, 4996, 722, 0, 0, 0, 0, 16, 16, 
                                                  16, 16, 16, 16, 0, 8, 14, 169, 0, 14, 1725, 172, 8, 0, 100, 0, 
                                                  100, 0, 0, 8, 0, 0, 0, 5053, 749, 0, 0, 0, 0, 8, 8, 8, 8, 8, 
                                                  8, 0, 10, 18, 255, 0, 16, 1678, 416, 10, 0, 96, 0, 118, 0, 0, 
                                                  10, 0, 0, 0, 5646, 870, 0, 0, 0, 0, 10, 10, 10, 10, 10, 10, 0, 
                                                  18, 36, 450, 0, 24, 2724, 813, 18, 0, 152, 0, 208, 0, 0, 18, 
                                                  0, 0, 0, 6767, 984, 0, 0, 0, 0, 18, 18, 18, 18, 18, 18, 0, 18, 
                                                  36, 419, 0, 24, 2353, 811, 18, 0, 144, 0, 177, 0, 0, 18, 0, 0, 
                                                  0, 7840, 1000, 0, 0, 0, 0, 18, 18, 18, 18, 18, 18, 0, 14, 29, 
                                                  281, 0, 20, 1240, 670, 14, 0, 98, 0, 90, 0, 0, 14, 0, 0, 0, 7703, 
                                                  931, 0, 0, 0, 0, 14, 14, 14, 14, 14, 14, 0, 10, 22, 287, 0, 16, 
                                                  1494, 828, 10, 0, 78, 0, 75, 0, 0, 10, 0, 0, 0, 6495, 939, 0, 
                                                  0, 0, 0, 10, 10, 10, 10, 10, 10, 0, 14, 25, 326, 0, 20, 1962, 
                                                  947, 14, 0, 84, 0, 82, 0, 0, 14, 0, 0, 0, 5843, 1038, 0, 0, 0, 
                                                  0, 14, 14, 14, 14, 14, 14, 0, 8, 16, 191, 0, 14, 1022, 568, 8, 
                                                  0, 60, 0, 46, 0, 0, 8, 0, 0, 0, 5554, 943, 0, 0, 0, 0, 8, 8, 
                                                  8, 8, 8, 8, 0, 8, 14, 202, 0, 14, 936, 867, 8, 0, 56, 0, 40, 
                                                  0, 0, 8, 0, 0, 0, 5188, 872, 0, 0, 0, 0, 8, 8, 8, 8, 8, 8, 0, 
                                                  10, 22, 330, 0, 16, 1636, 1456, 10, 0, 66, 0, 70, 0, 0, 10, 0, 
                                                  0, 0, 5095, 923, 0, 0, 0, 0, 10, 10, 10, 10, 10, 10, 0, 8, 14, 
                                                  202, 0, 14, 959, 857, 8, 0, 54, 0, 40, 0, 0, 8, 0, 0, 0, 5051, 
                                                  853, 0, 0, 0, 0, 8, 8, 8, 8, 8, 8, 0, 2, 6, 81, 0, 8, 295, 311, 
                                                  2, 0, 38, 0, 12, 0, 0, 2, 0, 0, 0, 5034, 768, 0, 0, 0, 0, 2, 
                                                  2, 2, 2, 2, 2, 0, 8, 14, 187, 0, 14, 803, 1002, 8, 0, 56, 0, 
                                                  29, 0, 0, 8, 0, 0, 0, 5114, 906, 0, 0, 0, 0, 8, 8, 8, 8, 8, 8, 
                                                  0, 10, 22, 281, 0, 16, 1215, 1585, 10, 0, 68, 0, 50, 0, 0, 10, 
                                                  0, 0, 0, 5230, 1073, 0, 0, 0, 0, 10, 10, 10, 10, 10, 10, 0, 14, 
                                                  25, 308, 0, 20, 1209, 1935, 14, 0, 76, 0, 62, 0, 0, 14, 0, 0, 
                                                  0, 5581, 1142, 0, 0, 0, 0, 14, 14, 14, 14, 14, 14, 0, 20, 38, 
                                                  445, 0, 26, 1458, 3255, 20, 0, 98, 0, 86, 0, 0, 20, 0, 0, 0, 
                                                  6151, 1346, 0, 0, 0, 0, 20, 20, 20, 20, 20, 20, 0, 18, 36, 405, 
                                                  0, 24, 1056, 3221, 18, 0, 88, 0, 78, 0, 0, 18, 0, 0, 0, 6366, 
                                                  1412, 0, 0, 0, 0, 18, 18, 18, 18, 18, 18, 0, 16, 30, 352, 0, 
                                                  22, 572, 2792, 16, 0, 82, 0, 68, 0, 0, 16, 0, 0, 0, 6419, 1442, 
                                                  0, 0, 0, 0, 16, 16, 16, 16, 16, 16, 0), .Dim = c(31L, 20L), .Dimnames = list(
                                                    c("Upper Sacramento River", "Antelope Creek", "Battle Creek", 
                                                      "Bear Creek", "Big Chico Creek", "Butte Creek", "Clear Creek", 
                                                      "Cottonwood Creek", "Cow Creek", "Deer Creek", "Elder Creek", 
                                                      "Mill Creek", "Paynes Creek", "Stony Creek", "Thomes Creek", 
                                                      "Upper-mid Sacramento River", "Sutter Bypass", "Bear River", 
                                                      "Feather River", "Yuba River", "Lower-mid Sacramento River", 
                                                      "Yolo Bypass", "American River", "Lower Sacramento River", 
                                                      "Calaveras River", "Cosumnes River", "Mokelumne River", "Merced River", 
                                                      "Stanislaus River", "Tuolumne River", "San Joaquin River"
                                                    ), c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", 
                                                         "12", "13", "14", "15", "16", "17", "18", "19", "20"))), 
                           juvenile_biomass = structure(c(0, 0, 10401.9, 0, 0, 62448, 
                                                          19969.3, 0, 0, 2339.5, 0, 3808, 0, 0, 0, 0, 0, 0, 104542.1, 
                                                          48004.9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 628, 1130.4, 121152.8, 
                                                          0, 0, 1499041.8, 300794.4, 0, 0, 68464.7, 0, 67755.2, 0, 
                                                          0, 0, 0, 0, 0, 913244.7, 203948.9, 0, 0, 0, 0, 0, 0, 0, 0, 
                                                          0, 0, 0, 628, 1130.4, 176757.5, 0, 0, 2090587.3, 445914.1, 
                                                          0, 0, 85880.3, 0, 88277.1, 0, 0, 0, 0, 0, 0, 1845096.4, 357168.4, 
                                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 628, 1287.4, 203589.4, 0, 
                                                          0, 2300666.3, 551453.8, 0, 0, 91304.3, 0, 94563, 0, 0, 0, 
                                                          0, 0, 0, 3153473.8, 471240.3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                                          0, 0, 628, 1296.5, 211684.6, 0, 0, 2337929, 578645.4, 0, 
                                                          0, 92216.2, 0, 96435.5, 0, 0, 0, 0, 0, 0, 3232391.1, 492224.5, 
                                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1256, 1641.9, 360456.8, 
                                                          0, 0, 3227460.2, 1108632.1, 0, 0, 115986.9, 0, 128281, 0, 
                                                          0, 0, 0, 0, 0, 3910494.1, 740372.3, 0, 0, 0, 0, 0, 0, 0, 
                                                          0, 0, 0, 0, 1256, 1641.9, 363658.6, 0, 0, 3235834.7, 1125203.2, 
                                                          0, 0, 116508.4, 0, 128986.8, 0, 0, 0, 0, 0, 0, 4009591.8, 
                                                          777402.8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1256, 1641.9, 
                                                          367504.2, 0, 0, 3258806.2, 1149578.4, 0, 0, 117076.3, 0, 
                                                          129405.9, 0, 0, 0, 0, 0, 0, 4076757.9, 812136.8, 0, 0, 0, 
                                                          0, 0, 0, 0, 0, 0, 0, 0, 1256, 1745.2, 401004.8, 0, 0, 3443544.7, 
                                                          1328275.3, 0, 0, 119220.5, 0, 135317.5, 0, 0, 0, 0, 0, 0, 
                                                          4095215.5, 881092.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1256, 
                                                          1745.2, 405195.4, 0, 0, 3463011.5, 1349364.9, 0, 0, 119656.9, 
                                                          0, 135853.1, 0, 0, 0, 0, 0, 0, 4109809.6, 914653.9, 0, 0, 
                                                          0, 0, 0, 0, 0, 0, 0, 0, 0, 1256, 1745.2, 408209.7, 0, 0, 
                                                          3480957.6, 1371353.8, 0, 0, 119899.9, 0, 136217.6, 0, 0, 
                                                          0, 0, 0, 0, 4125445.8, 928549.9, 0, 0, 0, 0, 0, 0, 0, 0, 
                                                          0, 0, 0, 1256, 1808, 420543.4, 0, 0, 3557219.3, 1469800.5, 
                                                          0, 0, 120730.4, 0, 137348.9, 0, 0, 0, 0, 0, 0, 4151137.8, 
                                                          956306.1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1256, 1808, 479857.6, 
                                                          0, 0, 3853388, 1905747.5, 0, 0, 127603.8, 0, 145337.2, 0, 
                                                          0, 0, 0, 0, 0, 4272826.7, 1233575.9, 0, 0, 0, 0, 0, 0, 0, 
                                                          0, 0, 0, 0, 1256, 1808, 480537.9, 0, 0, 3855387.5, 1913438.4, 
                                                          0, 0, 127896.4, 0, 145337.2, 0, 0, 0, 0, 0, 0, 4326705.8, 
                                                          1258536.1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1256, 1808, 555884, 
                                                          0, 0, 4157886, 2557105.7, 0, 0, 136236.5, 0, 155755.6, 0, 
                                                          0, 0, 0, 0, 0, 4922605.4, 1544612.2, 0, 0, 0, 0, 0, 0, 0, 
                                                          0, 0, 0, 0, 1256, 2162.5, 641766.5, 0, 0, 4414862.7, 3503769.1, 
                                                          0, 0, 143371.1, 0, 165457.7, 0, 0, 0, 0, 0, 0, 5618501.4, 
                                                          1938870, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1256, 2225.3, 658244.1, 
                                                          0, 0, 4459758.2, 3687814.5, 0, 0, 146857.4, 0, 167100.5, 
                                                          0, 0, 0, 0, 0, 0, 6152425.5, 2129240.6, 0, 0, 0, 0, 0, 0, 
                                                          0, 0, 0, 0, 0, 1955.9, 2548.4, 784756.1, 0, 0, 4711814.3, 
                                                          4800244.5, 0, 0, 160796.7, 0, 184855.1, 0, 0, 0, 0, 0, 0, 
                                                          6825257.7, 2459146.2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2740.9, 
                                                          2862.4, 917066, 0, 0, 5033299.7, 6098009.6, 0, 0, 175084.6, 
                                                          0, 203826.6, 0, 0, 0, 0, 0, 0, 9291537.5, 2871062.8, 0, 0, 
                                                          0, 0, 0, 0, 0, 0, 502.4, 0, 0, 3400.3, 3145, 1021953.7, 0, 
                                                          0, 5193776.8, 7171367.8, 0, 0, 187959.5, 0, 220891.8, 0, 
                                                          0, 0, 0, 0, 0, 9983634.6, 3289979.1, 0, 0, 0, 0, 0, 0, 0, 
                                                          0, 502.4, 0, 0), .Dim = c(31L, 20L), .Dimnames = list(c("Upper Sacramento River", 
                                                                                                                  "Antelope Creek", "Battle Creek", "Bear Creek", "Big Chico Creek", 
                                                                                                                  "Butte Creek", "Clear Creek", "Cottonwood Creek", "Cow Creek", 
                                                                                                                  "Deer Creek", "Elder Creek", "Mill Creek", "Paynes Creek", 
                                                                                                                  "Stony Creek", "Thomes Creek", "Upper-mid Sacramento River", 
                                                                                                                  "Sutter Bypass", "Bear River", "Feather River", "Yuba River", 
                                                                                                                  "Lower-mid Sacramento River", "Yolo Bypass", "American River", 
                                                                                                                  "Lower Sacramento River", "Calaveras River", "Cosumnes River", 
                                                                                                                  "Mokelumne River", "Merced River", "Stanislaus River", "Tuolumne River", 
                                                                                                                  "San Joaquin River"), c("1", "2", "3", "4", "5", "6", "7", 
                                                                                                                                          "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", 
                                                                                                                                          "18", "19", "20"))), proportion_natural = structure(c(0.999995833350694, 
                                                                                                                                                                                                0.999997826091682, 0.951830259762956, 0, 0.799997333342222, 
                                                                                                                                                                                                0.997321710791401, 0.996261496025889, 0.999995833350694, 
                                                                                                                                                                                                0, 0.913544405318615, 0, 0.999999753694642, 0, 0, 0.999995833350694, 
                                                                                                                                                                                                0, 0, 0, 0.00718706314260205, 0.0622462703320338, 0, 0, 0, 
                                                                                                                                                                                                0, 0.999995833350694, 0.999995833350694, 0.999995833350694, 
                                                                                                                                                                                                0.999995833350694, 0.999995833350694, 0.999995833350694, 
                                                                                                                                                                                                0, 0.999993750039062, 0.999996551736029, 0.924242144169047, 
                                                                                                                                                                                                0, 0.72726942150263, 0.995850596580638, 0.994202610376055, 
                                                                                                                                                                                                0.999993750039062, 0, 0.859154526218532, 0, 0.99999958677703, 
                                                                                                                                                                                                0, 0, 0.999993750039062, 0, 0, 0, 0.00460368285420971, 0.0401661994229641, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999993750039062, 0.999993750039062, 0.999993750039062, 
                                                                                                                                                                                                0.999993750039062, 0.999993750039062, 0.999993750039062, 
                                                                                                                                                                                                0, 0.999987500156248, 0.999992857193877, 0.852070501733431, 
                                                                                                                                                                                                0, 0.571424489825073, 0.99072458024785, 0.988371518388652, 
                                                                                                                                                                                                0.999987500156248, 0, 0.6999993000007, 0, 0.999999000001, 
                                                                                                                                                                                                0, 0, 0.999987500156248, 0, 0, 0, 0.0158321785902993, 0.0747663451580313, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999987500156248, 0.999987500156248, 0.999987500156248, 
                                                                                                                                                                                                0.999987500156248, 0.999987500156248, 0.999987500156248, 
                                                                                                                                                                                                0, 0.999990000099999, 0.999994444475308, 0.901960430603753, 
                                                                                                                                                                                                0, 0.624996093774414, 0.990464780067653, 0.995192068463445, 
                                                                                                                                                                                                0.999990000099999, 0, 0.687499283854913, 0, 0.999999152543091, 
                                                                                                                                                                                                0, 0, 0.999990000099999, 0, 0, 0, 0.119199431115844, 0.203448252477212, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999990000099999, 0.999990000099999, 0.999990000099999, 
                                                                                                                                                                                                0.999990000099999, 0.999990000099999, 0.999990000099999, 
                                                                                                                                                                                                0, 0.999994444475308, 0.999997222229938, 0.944444234567948, 
                                                                                                                                                                                                0, 0.749996875013021, 0.994126248380094, 0.997539852701125, 
                                                                                                                                                                                                0.999994444475308, 0, 0.802631050900624, 0, 0.999999519231, 
                                                                                                                                                                                                0, 0, 0.999994444475308, 0, 0, 0, 0.265110089181172, 0.295731677263041, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999994444475308, 0.999994444475308, 0.999994444475308, 
                                                                                                                                                                                                0.999994444475308, 0.999994444475308, 0.999994444475308, 
                                                                                                                                                                                                0, 0.999994444475308, 0.999997222229938, 0.940333904454915, 
                                                                                                                                                                                                0, 0.749996875013021, 0.9932001277858, 0.997533785754157, 
                                                                                                                                                                                                0.999994444475308, 0, 0.79166611689853, 0, 0.999999435028568, 
                                                                                                                                                                                                0, 0, 0.999994444475308, 0, 0, 0, 0.365688770845806, 0.306999969300003, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999994444475308, 0.999994444475308, 0.999994444475308, 
                                                                                                                                                                                                0.999994444475308, 0.999994444475308, 0.999994444475308, 
                                                                                                                                                                                                0, 0.999992857193877, 0.999996551736029, 0.91103170425918, 
                                                                                                                                                                                                0, 0.6999965000175, 0.987096694588976, 0.997014776564959, 
                                                                                                                                                                                                0.999992857193877, 0, 0.693876842982813, 0, 0.999998888890123, 
                                                                                                                                                                                                0, 0, 0.999992857193877, 0, 0, 0, 0.354407369149586, 0.255639070285814, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999992857193877, 0.999992857193877, 0.999992857193877, 
                                                                                                                                                                                                0.999992857193877, 0.999992857193877, 0.999992857193877, 
                                                                                                                                                                                                0, 0.999990000099999, 0.999995454566116, 0.912891667981997, 
                                                                                                                                                                                                0, 0.624996093774414, 0.989290429097026, 0.997584420581592, 
                                                                                                                                                                                                0.999990000099999, 0, 0.615383826430992, 0, 0.999998666668444, 
                                                                                                                                                                                                0, 0, 0.999990000099999, 0, 0, 0, 0.234334099548359, 0.261980802770948, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999990000099999, 0.999990000099999, 0.999990000099999, 
                                                                                                                                                                                                0.999990000099999, 0.999990000099999, 0.999990000099999, 
                                                                                                                                                                                                0, 0.999992857193877, 0.999996000016, 0.923312600210859, 
                                                                                                                                                                                                0, 0.6999965000175, 0.991845005512487, 0.997887962208241, 
                                                                                                                                                                                                0.999992857193877, 0, 0.642856377551931, 0, 0.999998780489292, 
                                                                                                                                                                                                0, 0, 0.999992857193877, 0, 0, 0, 0.148896112461131, 0.332369910176309, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999992857193877, 0.999992857193877, 0.999992857193877, 
                                                                                                                                                                                                0.999992857193877, 0.999992857193877, 0.999992857193877, 
                                                                                                                                                                                                0, 0.999987500156248, 0.999993750039062, 0.869109492612831, 
                                                                                                                                                                                                0, 0.571424489825073, 0.984344326385095, 0.996478697803046, 
                                                                                                                                                                                                0.999987500156248, 0, 0.499999166668056, 0, 0.999997826091682, 
                                                                                                                                                                                                0, 0, 0.999987500156248, 0, 0, 0, 0.104609288717874, 0.265111318652034, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999987500156248, 0.999987500156248, 0.999987500156248, 
                                                                                                                                                                                                0.999987500156248, 0.999987500156248, 0.999987500156248, 
                                                                                                                                                                                                0, 0.999987500156248, 0.999992857193877, 0.876237189981589, 
                                                                                                                                                                                                0, 0.571424489825073, 0.982905877894671, 0.997693079850856, 
                                                                                                                                                                                                0.999987500156248, 0, 0.464284885205562, 0, 0.99999750000625, 
                                                                                                                                                                                                0, 0, 0.999987500156248, 0, 0, 0, 0.0414417879444528, 0.205275205817064, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999987500156248, 0.999987500156248, 0.999987500156248, 
                                                                                                                                                                                                0.999987500156248, 0.999987500156248, 0.999987500156248, 
                                                                                                                                                                                                0, 0.999990000099999, 0.999995454566116, 0.924242144169047, 
                                                                                                                                                                                                0, 0.624996093774414, 0.990219988372861, 0.998626305039402, 
                                                                                                                                                                                                0.999990000099999, 0, 0.545453719009517, 0, 0.999998571430612, 
                                                                                                                                                                                                0, 0, 0.999990000099999, 0, 0, 0, 0.0239450436909707, 0.249187405288472, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999990000099999, 0.999990000099999, 0.999990000099999, 
                                                                                                                                                                                                0.999990000099999, 0.999990000099999, 0.999990000099999, 
                                                                                                                                                                                                0, 0.999987500156248, 0.999992857193877, 0.876237189981589, 
                                                                                                                                                                                                0, 0.571424489825073, 0.983315851583331, 0.997666161299164, 
                                                                                                                                                                                                0.999987500156248, 0, 0.444443621400701, 0, 0.99999750000625, 
                                                                                                                                                                                                0, 0, 0.999987500156248, 0, 0, 0, 0.0154424863305784, 0.18757324881908, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999987500156248, 0.999987500156248, 0.999987500156248, 
                                                                                                                                                                                                0.999987500156248, 0.999987500156248, 0.999987500156248, 
                                                                                                                                                                                                0, 0.999950002499875, 0.999983333611106, 0.691357171163986, 
                                                                                                                                                                                                0, 0.249996875039062, 0.945762391266986, 0.993568812357295, 
                                                                                                                                                                                                0.999950002499875, 0, 0.210525761774311, 0, 0.999991666736111, 
                                                                                                                                                                                                0, 0, 0.999950002499875, 0, 0, 0, 0.0121176000771236, 0.0976562372843441, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999950002499875, 0.999950002499875, 0.999950002499875, 
                                                                                                                                                                                                0.999950002499875, 0.999950002499875, 0.999950002499875, 
                                                                                                                                                                                                0, 0.999987500156248, 0.999992857193877, 0.86630969716059, 
                                                                                                                                                                                                0, 0.571424489825073, 0.980074597749116, 0.998003892414781, 
                                                                                                                                                                                                0.999987500156248, 0, 0.464284885205562, 0, 0.999996551736029, 
                                                                                                                                                                                                0, 0, 0.999987500156248, 0, 0, 0, 0.0275713721632504, 0.235099311799193, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999987500156248, 0.999987500156248, 0.999987500156248, 
                                                                                                                                                                                                0.999987500156248, 0.999987500156248, 0.999987500156248, 
                                                                                                                                                                                                0, 0.999990000099999, 0.999995454566116, 0.91103170425918, 
                                                                                                                                                                                                0, 0.624996093774414, 0.98683119449949, 0.998738107335135, 
                                                                                                                                                                                                0.999990000099999, 0, 0.558822707613665, 0, 0.999998000004, 
                                                                                                                                                                                                0, 0, 0.999990000099999, 0, 0, 0, 0.0491395784103331, 0.354147217693642, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999990000099999, 0.999990000099999, 0.999990000099999, 
                                                                                                                                                                                                0.999990000099999, 0.999990000099999, 0.999990000099999, 
                                                                                                                                                                                                0, 0.999992857193877, 0.999996000016, 0.918830870509458, 
                                                                                                                                                                                                0, 0.6999965000175, 0.986765840631444, 0.998966356642566, 
                                                                                                                                                                                                0.999992857193877, 0, 0.605262361496893, 0, 0.999998387099376, 
                                                                                                                                                                                                0, 0, 0.999992857193877, 0, 0, 0, 0.108941048039042, 0.393169842979874, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999992857193877, 0.999992857193877, 0.999992857193877, 
                                                                                                                                                                                                0.999992857193877, 0.999992857193877, 0.999992857193877, 
                                                                                                                                                                                                0, 0.999995000025, 0.999997368427978, 0.943820012624716, 
                                                                                                                                                                                                0, 0.769227810662267, 0.989025995265707, 0.999385529972795, 
                                                                                                                                                                                                0.999995000025, 0, 0.693876842982813, 0, 0.999998837210654, 
                                                                                                                                                                                                0, 0, 0.999995000025, 0, 0, 0, 0.191513571914915, 0.485141122946425, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999995000025, 0.999995000025, 0.999995000025, 
                                                                                                                                                                                                0.999995000025, 0.999995000025, 0.999995000025, 0, 0.999994444475308, 
                                                                                                                                                                                                0.999997222229938, 0.938271373266328, 0, 0.749996875013021, 
                                                                                                                                                                                                0.984848391586327, 0.999379043794503, 0.999994444475308, 
                                                                                                                                                                                                0, 0.659090160124818, 0, 0.999998717950362, 0, 0, 0.999994444475308, 
                                                                                                                                                                                                0, 0, 0, 0.218818721036464, 0.509206762804054, 0, 0, 0, 0, 
                                                                                                                                                                                                0.999994444475308, 0.999994444475308, 0.999994444475308, 
                                                                                                                                                                                                0.999994444475308, 0.999994444475308, 0.999994444475308, 
                                                                                                                                                                                                0, 0.999993750039062, 0.999996666677778, 0.92897700881335, 
                                                                                                                                                                                                0, 0.72726942150263, 0.972027802093042, 0.999283631830815, 
                                                                                                                                                                                                0.999993750039062, 0, 0.634145568115161, 0, 0.999998529413927, 
                                                                                                                                                                                                0, 0, 0.999993750039062, 0, 0, 0, 0.225268729938172, 0.519417439707529, 
                                                                                                                                                                                                0, 0, 0, 0, 0.999993750039062, 0.999993750039062, 0.999993750039062, 
                                                                                                                                                                                                0.999993750039062, 0.999993750039062, 0.999993750039062, 
                                                                                                                                                                                                0), .Dim = c(31L, 20L), .Dimnames = list(c("Upper Sacramento River", 
                                                                                                                                                                                                                                           "Antelope Creek", "Battle Creek", "Bear Creek", "Big Chico Creek", 
                                                                                                                                                                                                                                           "Butte Creek", "Clear Creek", "Cottonwood Creek", "Cow Creek", 
                                                                                                                                                                                                                                           "Deer Creek", "Elder Creek", "Mill Creek", "Paynes Creek", 
                                                                                                                                                                                                                                           "Stony Creek", "Thomes Creek", "Upper-mid Sacramento River", 
                                                                                                                                                                                                                                           "Sutter Bypass", "Bear River", "Feather River", "Yuba River", 
                                                                                                                                                                                                                                           "Lower-mid Sacramento River", "Yolo Bypass", "American River", 
                                                                                                                                                                                                                                           "Lower Sacramento River", "Calaveras River", "Cosumnes River", 
                                                                                                                                                                                                                                           "Mokelumne River", "Merced River", "Stanislaus River", "Tuolumne River", 
                                                                                                                                                                                                                                           "San Joaquin River"), c("1", "2", "3", "4", "5", "6", "7", 
                                                                                                                                                                                                                                                                   "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", 
                                                                                                                                                                                                                                                                   "18", "19", "20"))), viability_metrics = structure(c(0, 0, 
                                                                                                                                                                                                                                                                                                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 
                                                                                                                                                                                                                                                                                                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 
                                                                                                                                                                                                                                                                                                                        1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 
                                                                                                                                                                                                                                                                                                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), .Dim = c(19L, 
                                                                                                                                                                                                                                                                                                                                                                                     4L)))

expected_model_sim_stoch <- list(spawners = structure(c(25, 45, 534, 0, 24, 5992, 549, 18, 
                                                        0, 341, 0, 406, 0, 0, 21, 0, 0, 0, 5557, 850, 0, 0, 0, 0, 26, 
                                                        25, 17, 20, 21, 16, 0, 12, 26, 345, 0, 16, 3883, 353, 16, 0, 
                                                        211, 0, 235, 0, 0, 18, 0, 0, 0, 5714, 844, 0, 0, 0, 0, 17, 17, 
                                                        17, 22, 19, 14, 0, 7, 21, 186, 0, 13, 1765, 172, 8, 0, 119, 0, 
                                                        113, 0, 0, 4, 0, 0, 0, 7078, 1066, 0, 0, 0, 0, 12, 12, 6, 6, 
                                                        9, 9, 0, 18, 28, 340, 0, 33, 3845, 517, 13, 0, 196, 0, 202, 0, 
                                                        0, 12, 0, 0, 0, 7247, 1196, 0, 0, 0, 0, 8, 22, 21, 25, 22, 15, 
                                                        0, 29, 75, 740, 0, 50, 7141, 1013, 43, 0, 291, 0, 331, 0, 0, 
                                                        35, 0, 0, 0, 9326, 1428, 0, 0, 0, 0, 38, 36, 36, 34, 26, 29, 
                                                        0, 28, 58, 711, 0, 32, 4700, 772, 31, 0, 193, 0, 204, 0, 0, 23, 
                                                        0, 0, 0, 11151, 1446, 0, 0, 0, 0, 33, 32, 29, 34, 30, 34, 0, 
                                                        10, 31, 365, 0, 22, 1644, 485, 22, 0, 89, 0, 69, 0, 0, 12, 0, 
                                                        0, 0, 8761, 1025, 0, 0, 0, 0, 16, 16, 11, 10, 22, 13, 0, 20, 
                                                        32, 396, 0, 17, 3129, 863, 11, 0, 114, 0, 78, 0, 0, 21, 0, 0, 
                                                        0, 6027, 899, 0, 0, 0, 0, 18, 16, 13, 17, 15, 15, 0, 20, 52, 
                                                        497, 0, 16, 4252, 938, 24, 0, 134, 0, 82, 0, 0, 21, 0, 0, 0, 
                                                        5198, 970, 0, 0, 0, 0, 28, 24, 21, 19, 18, 14, 0, 11, 17, 279, 
                                                        0, 16, 2032, 543, 14, 0, 101, 0, 63, 0, 0, 12, 0, 0, 0, 6814, 
                                                        1225, 0, 0, 0, 0, 9, 11, 13, 13, 12, 12, 0, 17, 35, 375, 0, 15, 
                                                        3016, 1053, 17, 0, 100, 0, 32, 0, 0, 17, 0, 0, 0, 5710, 1101, 
                                                        0, 0, 0, 0, 16, 20, 24, 17, 22, 19, 0, 28, 49, 675, 0, 27, 5319, 
                                                        1782, 31, 0, 160, 0, 56, 0, 0, 26, 0, 0, 0, 3988, 752, 0, 0, 
                                                        0, 0, 25, 25, 20, 29, 34, 34, 0, 13, 22, 387, 0, 25, 3269, 1184, 
                                                        11, 0, 122, 0, 23, 0, 0, 18, 0, 0, 0, 5521, 892, 0, 0, 0, 0, 
                                                        19, 14, 14, 8, 15, 17, 0, 5, 9, 104, 0, 7, 864, 330, 3, 0, 55, 
                                                        0, 6, 0, 0, 3, 0, 0, 0, 7402, 1030, 0, 0, 0, 0, 3, 6, 9, 2, 5, 
                                                        7, 0, 9, 13, 179, 0, 13, 1194, 726, 9, 0, 67, 0, 20, 0, 0, 6, 
                                                        0, 0, 0, 6942, 1017, 0, 0, 0, 0, 2, 4, 6, 6, 7, 6, 0, 11, 26, 
                                                        303, 0, 10, 1566, 1193, 11, 0, 51, 0, 19, 0, 0, 12, 0, 0, 0, 
                                                        6097, 843, 0, 0, 0, 0, 12, 9, 14, 7, 11, 8, 0, 14, 36, 459, 0, 
                                                        21, 1619, 1387, 18, 0, 64, 0, 90, 0, 0, 12, 0, 0, 0, 4856, 808, 
                                                        0, 0, 0, 0, 16, 9, 11, 14, 16, 18, 0, 21, 47, 820, 0, 37, 2653, 
                                                        3237, 30, 0, 90, 0, 182, 0, 0, 16, 0, 0, 0, 5721, 1373, 0, 0, 
                                                        0, 0, 24, 22, 35, 23, 20, 27, 0, 23, 67, 806, 0, 38, 2761, 4109, 
                                                        36, 0, 103, 0, 152, 0, 0, 25, 0, 0, 0, 6112, 1481, 0, 0, 0, 0, 
                                                        29, 35, 36, 32, 33, 28, 0, 39, 84, 1387, 0, 45, 2238, 5266, 43, 
                                                        0, 137, 0, 149, 0, 0, 35, 0, 0, 0, 8656, 2185, 0, 0, 0, 0, 25, 
                                                        43, 36, 34, 35, 37, 0), .Dim = c(31L, 20L), .Dimnames = list(
                                                          c("Upper Sacramento River", "Antelope Creek", "Battle Creek", 
                                                            "Bear Creek", "Big Chico Creek", "Butte Creek", "Clear Creek", 
                                                            "Cottonwood Creek", "Cow Creek", "Deer Creek", "Elder Creek", 
                                                            "Mill Creek", "Paynes Creek", "Stony Creek", "Thomes Creek", 
                                                            "Upper-mid Sacramento River", "Sutter Bypass", "Bear River", 
                                                            "Feather River", "Yuba River", "Lower-mid Sacramento River", 
                                                            "Yolo Bypass", "American River", "Lower Sacramento River", 
                                                            "Calaveras River", "Cosumnes River", "Mokelumne River", "Merced River", 
                                                            "Stanislaus River", "Tuolumne River", "San Joaquin River"
                                                          ), c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", 
                                                               "12", "13", "14", "15", "16", "17", "18", "19", "20"))), 
                                 juvenile_biomass = structure(c(0, 0, 7470.8, 0, 0, 73991.6, 
                                                                17724.9, 0, 0, 3201.4, 0, 5702.9, 0, 0, 0, 0, 0, 0, 68237, 
                                                                36232.7, 0, 0, 0, 0, 0, 0, 0, 0, 31.4, 0, 0, 282.6, 0, 93379.8, 
                                                                0, 0, 1641791.3, 205802.7, 1789.8, 0, 66598, 0, 61197.6, 
                                                                0, 0, 0, 0, 0, 0, 910385, 229562.5, 0, 0, 0, 0, 0, 0, 0, 
                                                                0, 31.4, 0, 0, 282.6, 0, 234539, 0, 0, 2470131.8, 333570.6, 
                                                                1789.8, 0, 66598, 0, 73776.7, 0, 0, 0, 0, 0, 0, 2463197.3, 
                                                                460460.3, 0, 0, 0, 0, 0, 0, 0, 0, 345.4, 0, 0, 282.6, 0, 
                                                                271618.6, 0, 376.8, 2972127.3, 447693.8, 2920.2, 0, 86683.5, 
                                                                0, 76908.5, 0, 0, 0, 0, 0, 0, 4331199, 605464.1, 0, 0, 0, 
                                                                0, 0, 0, 0, 0, 345.4, 0, 0, 332.2, 18.2, 289123.5, 0, 376.8, 
                                                                3099613.9, 493597.5, 2920.2, 0, 89189.4, 0, 78464.3, 0, 0, 
                                                                0, 0, 0, 0, 4451421.2, 625654.2, 0, 0, 0, 0, 0, 0, 0, 0, 
                                                                345.4, 0, 0, 2153.4, 18.2, 470409.3, 0, 973.4, 4862979.5, 
                                                                939772.3, 2920.2, 0, 144158.5, 0, 102809.3, 0, 0, 1664.2, 
                                                                0, 0, 0, 5136710.1, 875257.7, 0, 0, 0, 0, 0, 0, 0, 0, 345.4, 
                                                                0, 0, 2153.4, 18.2, 477335.2, 0, 973.4, 4881663.1, 956498.8, 
                                                                2920.2, 0, 145437.2, 0, 103948.3, 0, 0, 1664.2, 0, 0, 0, 
                                                                5184886.8, 908968.1, 0, 0, 0, 0, 0, 0, 0, 0, 345.4, 0, 0, 
                                                                2153.4, 18.2, 482456.7, 0, 982.5, 4930503.3, 986896.5, 2920.2, 
                                                                0, 147005.3, 0, 104814.7, 0, 0, 1664.2, 0, 0, 0, 5279455, 
                                                                973955.8, 0, 0, 0, 0, 0, 0, 0, 0, 345.4, 0, 0, 2153.4, 139.7, 
                                                                546571.7, 0, 1085.8, 5503131.1, 1173936.6, 3271.5, 0, 160235.9, 
                                                                0, 104814.7, 0, 0, 2024.6, 0, 0, 0, 5291057.5, 1030664.2, 
                                                                0, 0, 0, 0, 0, 0, 0, 0, 345.4, 0, 0, 2153.4, 139.7, 550300.8, 
                                                                0, 1085.8, 5544159, 1204998.9, 3280.6, 0, 161106.4, 0, 104814.7, 
                                                                0, 0, 2024.6, 0, 0, 0, 5293757.9, 1040461, 0, 0, 0, 0, 0, 
                                                                0, 0, 0, 345.4, 0, 0, 2153.4, 139.7, 553777.4, 0, 1085.8, 
                                                                5612745.1, 1229239.7, 3280.6, 0, 161106.4, 0, 104814.7, 0, 
                                                                0, 2024.6, 0, 0, 0, 5417965, 1069372, 0, 0, 0, 0, 0, 0, 0, 
                                                                0, 345.4, 0, 0, 2184.8, 139.7, 573042.4, 0, 1148.6, 5820080.2, 
                                                                1346819.4, 3280.6, 0, 161667.5, 0, 106017, 0, 0, 2024.6, 
                                                                0, 0, 0, 5423774.9, 1094674.9, 0, 0, 0, 0, 0, 0, 0, 0, 345.4, 
                                                                0, 0, 2184.8, 422.3, 667874.4, 0, 1148.6, 6680810.9, 1868255.8, 
                                                                3280.6, 0, 170262.9, 0, 106017, 0, 0, 2024.6, 0, 0, 0, 6581272.8, 
                                                                1284307.2, 0, 0, 0, 0, 0, 0, 0, 0, 345.4, 0, 0, 2184.8, 422.3, 
                                                                670864.5, 0, 1148.6, 6689744.4, 1878393.4, 3280.6, 0, 170262.9, 
                                                                0, 106017, 0, 0, 2024.6, 0, 0, 0, 6706326.7, 1293884.2, 0, 
                                                                0, 0, 0, 0, 0, 0, 0, 376.8, 0, 0, 2184.8, 422.3, 778612.2, 
                                                                0, 1148.6, 7018122.3, 2245229.9, 3280.6, 0, 170262.9, 0, 
                                                                129421.8, 0, 0, 2024.6, 0, 0, 0, 6935699.6, 1496696.8, 0, 
                                                                0, 0, 0, 0, 0, 0, 0, 376.8, 94.2, 0, 2184.8, 839.6, 872836, 
                                                                0, 1148.6, 7367130.5, 2869369.9, 4882, 0, 178317.2, 0, 140799, 
                                                                0, 0, 2024.6, 0, 0, 0, 7650081, 1776879, 0, 0, 0, 0, 0, 0, 
                                                                0, 0, 376.8, 94.2, 0, 2184.8, 902.4, 889981.2, 0, 1148.6, 
                                                                7431920, 3005062.3, 5604.2, 0, 180062.4, 0, 142503.7, 0, 
                                                                0, 2024.6, 0, 0, 0, 8033529.6, 1940227.7, 0, 0, 0, 0, 0, 
                                                                0, 0, 0, 376.8, 125.6, 0, 4382.8, 1319.7, 1276670.5, 0, 1148.6, 
                                                                7829209, 4255508.9, 7896.4, 0, 181986.9, 0, 169708.8, 0, 
                                                                0, 3688.8, 0, 0, 0, 8784737.5, 2449528.6, 0, 0, 0, 0, 0, 
                                                                0, 0, 0, 376.8, 125.6, 0, 5042.2, 2638.5, 1475014.1, 0, 1148.6, 
                                                                8716856.4, 5596008.7, 7896.4, 0, 181986.9, 0, 195068.6, 0, 
                                                                0, 4662.2, 0, 0, 0, 11394315.4, 3040091, 0, 0, 0, 0, 0, 0, 
                                                                0, 0, 1193.2, 125.6, 0, 5387.6, 2669.9, 1834399.9, 0, 1148.6, 
                                                                9327762.2, 6632707.9, 9309.4, 0, 195857.5, 0, 204234.2, 0, 
                                                                0, 4662.2, 0, 0, 0, 12404941.3, 3604369.2, 0, 0, 0, 0, 0, 
                                                                0, 0, 0, 1475.8, 1004.8, 0), .Dim = c(31L, 20L), .Dimnames = list(
                                                                  c("Upper Sacramento River", "Antelope Creek", "Battle Creek", 
                                                                    "Bear Creek", "Big Chico Creek", "Butte Creek", "Clear Creek", 
                                                                    "Cottonwood Creek", "Cow Creek", "Deer Creek", "Elder Creek", 
                                                                    "Mill Creek", "Paynes Creek", "Stony Creek", "Thomes Creek", 
                                                                    "Upper-mid Sacramento River", "Sutter Bypass", "Bear River", 
                                                                    "Feather River", "Yuba River", "Lower-mid Sacramento River", 
                                                                    "Yolo Bypass", "American River", "Lower Sacramento River", 
                                                                    "Calaveras River", "Cosumnes River", "Mokelumne River", 
                                                                    "Merced River", "Stanislaus River", "Tuolumne River", 
                                                                    "San Joaquin River"), c("1", "2", "3", "4", "5", "6", 
                                                                                            "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", 
                                                                                            "17", "18", "19", "20"))), proportion_natural = structure(c(0.999996000016, 
                                                                                                                                                        0.999997777782716, 0.949438024449808, 0, 0.874996354181858, 
                                                                                                                                                        0.99666219965517, 0.998178324557682, 0.944439197560014, 0, 
                                                                                                                                                        0.932551046172714, 0, 0.999999753694642, 0, 0, 0.999995238117914, 
                                                                                                                                                        0, 0, 0, 0.00377901738745695, 0.0482352884429072, 0, 0, 0, 
                                                                                                                                                        0, 0.999996153860947, 0.999996000016, 0.999994117681661, 
                                                                                                                                                        0.999995000025, 0.999995238117914, 0.999993750039062, 0, 
                                                                                                                                                        0.999991666736111, 0.999996153860947, 0.878260614996923, 
                                                                                                                                                        0, 0.562496484396973, 0.99407671918422, 0.991501135552086, 
                                                                                                                                                        0.999993750039062, 0, 0.843601495923462, 0, 0.999999574468266, 
                                                                                                                                                        0, 0, 0.999994444475308, 0, 0, 0, 0.0033251662001196, 0.0379146874508664, 
                                                                                                                                                        0, 0, 0, 0, 0.999994117681661, 0.999994117681661, 0.999994117681661, 
                                                                                                                                                        0.999995454566116, 0.999994736869806, 0.999992857193877, 
                                                                                                                                                        0, 0.999985714489793, 0.85713877552964, 0.806451179327323, 
                                                                                                                                                        0, 0.615379881693218, 0.980169916137682, 0.965115717955978, 
                                                                                                                                                        0.999987500156248, 0, 0.537814674105316, 0, 0.999999115045031, 
                                                                                                                                                        0, 0, 0.999975000624984, 0, 0, 0, 0.00607516238944388, 0.0393996210694539, 
                                                                                                                                                        0, 0, 0, 0, 0.999991666736111, 0.999991666736111, 0.999983333611106, 
                                                                                                                                                        0.999983333611106, 0.999988889012344, 0.999988889012344, 
                                                                                                                                                        0, 0.999994444475308, 0.928568112256742, 0.908823262110805, 
                                                                                                                                                        0, 0.848482277326432, 0.995058491675982, 0.996131335371115, 
                                                                                                                                                        0.999992307751479, 0, 0.841836305185559, 0, 0.99999950495074, 
                                                                                                                                                        0, 0, 0.999991666736111, 0, 0, 0, 0.170553330059979, 0.252508340091276, 
                                                                                                                                                        0, 0, 0, 0, 0.999987500156248, 0.999995454566116, 0.999995238117914, 
                                                                                                                                                        0.999996000016, 0.999995454566116, 0.999993333377778, 0, 
                                                                                                                                                        0.999996551736029, 0.999998666668444, 0.966216085646475, 
                                                                                                                                                        0, 0.83999832000336, 0.997059221438745, 0.999012734549582, 
                                                                                                                                                        0.999997674424013, 0, 0.872851933727858, 0, 0.999999697885288, 
                                                                                                                                                        0, 0, 0.999997142865306, 0, 0, 0, 0.360711984122754, 0.398459355850185, 
                                                                                                                                                        0, 0, 0, 0, 0.999997368427978, 0.999997222229938, 0.999997222229938, 
                                                                                                                                                        0.99999705883218, 0.999996153860947, 0.999996551736029, 0, 
                                                                                                                                                        0.999996428584184, 0.965515576697281, 0.947960485518919, 
                                                                                                                                                        0, 0.9062471679776, 0.995744659665007, 0.997409197226788, 
                                                                                                                                                        0.999996774203954, 0, 0.777201669843694, 0, 0.999999509804162, 
                                                                                                                                                        0, 0, 0.999995652192817, 0, 0, 0, 0.371267147598716, 0.322268304130823, 
                                                                                                                                                        0, 0, 0, 0, 0.999996969706152, 0.999996875009766, 0.999996551736029, 
                                                                                                                                                        0.99999705883218, 0.999996666677778, 0.99999705883218, 0, 
                                                                                                                                                        0.999990000099999, 0.967738813745762, 0.926027143554207, 
                                                                                                                                                        0, 0.681815082658715, 0.987226217322006, 0.991752372834562, 
                                                                                                                                                        0.954541115722201, 0, 0.539325236713217, 0, 0.999998550726738, 
                                                                                                                                                        0, 0, 0.999991666736111, 0, 0, 0, 0.31925578907367, 0.239999976585368, 
                                                                                                                                                        0, 0, 0, 0, 0.999993750039062, 0.999993750039062, 0.999990909173553, 
                                                                                                                                                        0.999990000099999, 0.999995454566116, 0.999992307751479, 
                                                                                                                                                        0, 0.999995000025, 0.999996875009766, 0.946969457835996, 
                                                                                                                                                        0, 0.941170934288622, 0.994566922513042, 0.998841135707864, 
                                                                                                                                                        0.999990909173553, 0, 0.745613381040894, 0, 0.999998717950362, 
                                                                                                                                                        0, 0, 0.999995238117914, 0, 0, 0, 0.249709635810359, 0.298108976851059, 
                                                                                                                                                        0, 0, 0, 0, 0.999994444475308, 0.999993750039062, 0.999992307751479, 
                                                                                                                                                        0.999994117681661, 0.999993333377778, 0.999993333377778, 
                                                                                                                                                        0, 0.999995000025, 0.980767344678183, 0.949697998048693, 
                                                                                                                                                        0, 0.937494140661621, 0.995061124293012, 0.997867697455469, 
                                                                                                                                                        0.999995833350694, 0, 0.850745633771915, 0, 0.999998780489292, 
                                                                                                                                                        0, 0, 0.999995238117914, 0, 0, 0, 0.192958826607179, 0.407216452864283, 
                                                                                                                                                        0, 0, 0, 0, 0.999996428584184, 0.999995833350694, 0.999995238117914, 
                                                                                                                                                        0.999994736869806, 0.999994444475308, 0.999992857193877, 
                                                                                                                                                        0, 0.999990909173553, 0.999994117681661, 0.870967429760778, 
                                                                                                                                                        0, 0.812494921906738, 0.989173179666674, 0.994474954976988, 
                                                                                                                                                        0.928564795965743, 0, 0.564355876875369, 0, 0.999998412700932, 
                                                                                                                                                        0, 0, 0.999991666736111, 0, 0, 0, 0.0861461683864666, 0.275102018359019, 
                                                                                                                                                        0, 0, 0, 0, 0.999988889012344, 0.999990909173553, 0.999992307751479, 
                                                                                                                                                        0.999992307751479, 0.999991666736111, 0.999991666736111, 
                                                                                                                                                        0, 0.999994117681661, 0.971425795926297, 0.922666420622288, 
                                                                                                                                                        0, 0.799994666702222, 0.99635275211032, 0.997150902454805, 
                                                                                                                                                        0.941170934288622, 0, 0.67999932000068, 0, 0.999996875009766, 
                                                                                                                                                        0, 0, 0.999994117681661, 0, 0, 0, 0.0569176872693925, 0.287011781379493, 
                                                                                                                                                        0, 0, 0, 0, 0.999993750039062, 0.999995000025, 0.999995833350694, 
                                                                                                                                                        0.999994117681661, 0.999995454566116, 0.999994736869806, 
                                                                                                                                                        0, 0.999996428584184, 0.999997959187838, 0.968888745349816, 
                                                                                                                                                        0, 0.703701097403343, 0.997931923332733, 0.998877609490594, 
                                                                                                                                                        0.999996774203954, 0, 0.837499476562827, 0, 0.999998214288903, 
                                                                                                                                                        0, 0, 0.999996153860947, 0, 0, 0, 0.0426278825820491, 0.349733996046011, 
                                                                                                                                                        0, 0, 0, 0, 0.999996000016, 0.999996000016, 0.999995000025, 
                                                                                                                                                        0.999996551736029, 0.99999705883218, 0.99999705883218, 0, 
                                                                                                                                                        0.999992307751479, 0.954541115722201, 0.896640595183309, 
                                                                                                                                                        0, 0.71999712001152, 0.995105506420755, 0.999999915540548, 
                                                                                                                                                        0.999990909173553, 0, 0.729507598764263, 0, 0.999995652192817, 
                                                                                                                                                        0, 0, 0.999994444475308, 0, 0, 0, 0.0519833354105536, 0.181614329415434, 
                                                                                                                                                        0, 0, 0, 0, 0.999994736869806, 0.999992857193877, 0.999992857193877, 
                                                                                                                                                        0.999987500156248, 0.999993333377778, 0.999994117681661, 
                                                                                                                                                        0, 0.999980000399992, 0.999988889012344, 0.663460900518365, 
                                                                                                                                                        0, 0, 0.976851738790308, 0.99393909274573, 0.66664444518516, 
                                                                                                                                                        0, 0.145454280992216, 0, 0.999983333611106, 0, 0, 0.999966667777741, 
                                                                                                                                                        0, 0, 0, 0.0663334225029259, 0.124271832594968, 0, 0, 0, 
                                                                                                                                                        0, 0.999966667777741, 0.999983333611106, 0.999988889012344, 
                                                                                                                                                        0.999950002499875, 0.999980000399992, 0.999985714489793, 
                                                                                                                                                        0, 0.999988889012344, 0.999992307751479, 0.860334714896807, 
                                                                                                                                                        0, 0.538457396481566, 0.985762061493965, 0.998622451980379, 
                                                                                                                                                        0.77776913589849, 0, 0.328357718869076, 0, 0.999995000025, 
                                                                                                                                                        0, 0, 0.999983333611106, 0, 0, 0, 0.0927686532300684, 0.123893793127454, 
                                                                                                                                                        0, 0, 0, 0, 0.999950002499875, 0.999975000624984, 0.999983333611106, 
                                                                                                                                                        0.999983333611106, 0.999985714489793, 0.999983333611106, 
                                                                                                                                                        0, 0.999990909173553, 0.961534763327833, 0.933993091091389, 
                                                                                                                                                        0, 0.799992000079999, 0.992975670946637, 0.997485247486568, 
                                                                                                                                                        0.999990909173553, 0, 0.392156093811581, 0, 0.999994736869806, 
                                                                                                                                                        0, 0, 0.999991666736111, 0, 0, 0, 0.169099554385771, 0.1720047245546, 
                                                                                                                                                        0, 0, 0, 0, 0.999991666736111, 0.999988889012344, 0.999992857193877, 
                                                                                                                                                        0.999985714489793, 0.999990909173553, 0.999987500156248, 
                                                                                                                                                        0, 0.999992857193877, 0.999997222229938, 0.95424815811587, 
                                                                                                                                                        0, 0.809519954666883, 0.991970290798623, 0.999999927901952, 
                                                                                                                                                        0.999994444475308, 0, 0.578124096681099, 0, 0.999998888890123, 
                                                                                                                                                        0, 0, 0.999991666736111, 0, 0, 0, 0.189662269570382, 0.362623717497065, 
                                                                                                                                                        0, 0, 0, 0, 0.999993750039062, 0.999988889012344, 0.999990909173553, 
                                                                                                                                                        0.999992857193877, 0.999993750039062, 0.999994444475308, 
                                                                                                                                                        0, 0.999995238117914, 0.978721321869528, 0.98048768530638, 
                                                                                                                                                        0, 0.864862527398574, 0.99434598588971, 0.999691041096971, 
                                                                                                                                                        0.966663444455185, 0, 0.755554716050315, 0, 0.999999450549752, 
                                                                                                                                                        0, 0, 0.999993750039062, 0, 0, 0, 0.240866977086751, 0.586307313451762, 
                                                                                                                                                        0, 0, 0, 0, 0.999995833350694, 0.999995454566116, 0.999997142865306, 
                                                                                                                                                        0.999995652192817, 0.999995000025, 0.999996296310014, 0, 
                                                                                                                                                        0.999995652192817, 0.970147805749544, 0.978908067132994, 
                                                                                                                                                        0, 0.868418767319033, 0.996740275380649, 0.999756607452991, 
                                                                                                                                                        0.944441820994942, 0, 0.85436810255524, 0, 0.999999342105696, 
                                                                                                                                                        0, 0, 0.999996000016, 0, 0, 0, 0.364201564721833, 0.653612379904633, 
                                                                                                                                                        0, 0, 0, 0, 0.999996551736029, 0.999997142865306, 0.999997222229938, 
                                                                                                                                                        0.999996875009766, 0.999996969706152, 0.999996428584184, 
                                                                                                                                                        0, 0.99999743590401, 0.97618931406034, 0.971881689121724, 
                                                                                                                                                        0, 0.911109086424252, 0.990169750215829, 0.999810083558487, 
                                                                                                                                                        0.999997674424013, 0, 0.773722062976596, 0, 0.999999328859511, 
                                                                                                                                                        0, 0, 0.999997142865306, 0, 0, 0, 0.306723656345614, 0.6118992854966, 
                                                                                                                                                        0, 0, 0, 0, 0.999996000016, 0.999997674424013, 0.999997222229938, 
                                                                                                                                                        0.99999705883218, 0.999997142865306, 0.999997297304602, 0
                                                                                            ), .Dim = c(31L, 20L), .Dimnames = list(c("Upper Sacramento River", 
                                                                                                                                      "Antelope Creek", "Battle Creek", "Bear Creek", "Big Chico Creek", 
                                                                                                                                      "Butte Creek", "Clear Creek", "Cottonwood Creek", "Cow Creek", 
                                                                                                                                      "Deer Creek", "Elder Creek", "Mill Creek", "Paynes Creek", 
                                                                                                                                      "Stony Creek", "Thomes Creek", "Upper-mid Sacramento River", 
                                                                                                                                      "Sutter Bypass", "Bear River", "Feather River", "Yuba River", 
                                                                                                                                      "Lower-mid Sacramento River", "Yolo Bypass", "American River", 
                                                                                                                                      "Lower Sacramento River", "Calaveras River", "Cosumnes River", 
                                                                                                                                      "Mokelumne River", "Merced River", "Stanislaus River", "Tuolumne River", 
                                                                                                                                      "San Joaquin River"), c("1", "2", "3", "4", "5", "6", "7", 
                                                                                                                                                              "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", 
                                                                                                                                                              "18", "19", "20"))), viability_metrics = structure(c(0, 0, 
                                                                                                                                                                                                                   0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                                                                                                                                                                                                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 
                                                                                                                                                                                                                   0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 
                                                                                                                                                                                                                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), .Dim = c(19L, 
                                                                                                                                                                                                                                                                                4L)))

#Deterministic
test_that("model simulation returns correct data structure and values (determenistic)", {
    model_sim <- spring_run_model(seeds = expected_model_seeds, mode = "simulate")
    
    expect_equal(length(model_sim), 4)
    expect_equal(names(model_sim), c("spawners", "juvenile_biomass", "proportion_natural", "viability_metrics"))
    expect_equal(dim(model_sim$spawners), c(31, 20))
    expect_equal(dim(model_sim$juvenile_biomass), c(31, 20))
    expect_equal(dim(model_sim$proportion_natural), c(31, 20))
    
    # correct values
    expect_equal(model_sim, expected_model_sim)
  })


#Stochastic
test_that("model simulation returns correct data structure and values (stochastic)", {
  set.seed(2021)
  model_sim <- spring_run_model(seeds = expected_model_seeds, mode = "simulate", 
                                stochastic = TRUE)
  
  expect_equal(length(model_sim), 4)
  expect_equal(names(model_sim), c("spawners", "juvenile_biomass", "proportion_natural", "viability_metrics"))
  expect_equal(dim(model_sim$spawners), c(31, 20))
  expect_equal(dim(model_sim$juvenile_biomass), c(31, 20))
  expect_equal(dim(model_sim$proportion_natural), c(31, 20))
  
  # correct values
  expect_equal(model_sim, expected_model_sim_stoch)
})
